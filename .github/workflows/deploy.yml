name: Deploy Flutter Web App

on:
push:
branches:
- main

jobs:
deploy:
permissions:
contents: write # リポジトリへの書き込みを許可する
pages: write    # GitHub Pagesへのデプロイを許可する
id-token: write # OIDCトークンを生成する

runs-on: ubuntu-latest
steps:
  - name: Checkout Repository
    uses: actions/checkout@v2

  - name: Set up Flutter
    uses: subosito/flutter-action@v2
    with:
      flutter-version: '3.16.5' # 使用したいFlutterのバージョンを指定
      channel: 'stable'

  - name: Install dependencies
    run: flutter pub get

  - name: Build Web
    run: flutter build web --release --base-href="/cgsfes63-web/"

  - name: Deploy to GitHub Pages
    uses: JamesIves/github-pages-deploy-action@v4
    with:
      branch: gh-pages
      folder: build/web

